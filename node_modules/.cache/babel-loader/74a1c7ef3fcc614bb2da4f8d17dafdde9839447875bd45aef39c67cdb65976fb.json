{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"page-wrapper\",\n  id: \"main-wrapper\",\n  \"data-layout\": \"vertical\",\n  \"data-navbarbg\": \"skin6\",\n  \"data-sidebartype\": \"full\",\n  \"data-sidebar-position\": \"fixed\",\n  \"data-header-position\": \"fixed\"\n};\nconst _hoisted_2 = {\n  class: \"body-wrapper\",\n  style: {\n    \"margin-top\": \"-3rem\"\n  }\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nconst _hoisted_6 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_IndexComponent = _resolveComponent(\"IndexComponent\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" Sidebar Component \"), _createVNode(_component_IndexComponent), _createElementVNode(\"div\", _hoisted_2, [_cache[9] || (_cache[9] = _createElementVNode(\"h2\", {\n    style: {\n      \"margin-left\": \"2rem\",\n      \"margin-right\": \"2rem\"\n    }\n  }, \"Change Password\", -1 /* HOISTED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[3] || (_cache[3] = _withModifiers((...args) => $options.changePassword && $options.changePassword(...args), [\"prevent\"])),\n    style: {\n      \"margin-left\": \"2rem\",\n      \"margin-right\": \"2rem\"\n    }\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", {\n    for: \"current_password\",\n    class: \"form-label\"\n  }, \"Current password:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.currentPassword = $event),\n    class: \"form-control\",\n    id: \"current_password\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.currentPassword]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    for: \"new_password\",\n    class: \"form-label\"\n  }, \"New password:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.newPassword = $event),\n    class: \"form-control\",\n    id: \"new_password\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.newPassword]])]), _createElementVNode(\"div\", _hoisted_5, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    for: \"confirm_password\",\n    class: \"form-label\"\n  }, \"Confirm New Password:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.confirmPassword = $event),\n    class: \"form-control\",\n    id: \"confirm_password\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.confirmPassword]])]), _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary\",\n    disabled: $data.loading\n  }, _toDisplayString($data.loading ? 'Changing...' : 'Change'), 9 /* TEXT, PROPS */, _hoisted_6), _cache[7] || (_cache[7] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _cache[8] || (_cache[8] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), $data.passwordMessage ? (_openBlock(), _createElementBlock(\"p\", {\n    key: 0,\n    class: _normalizeClass([\"alert alert-danger\", $data.passwordMessageClass]),\n    style: {\n      \"margin-left\": \"5rem\"\n    }\n  }, _toDisplayString($data.passwordMessage), 3 /* TEXT, CLASS */)) : _createCommentVNode(\"v-if\", true)], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","id","style","_createElementBlock","_hoisted_1","_createCommentVNode","_createVNode","_component_IndexComponent","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","changePassword","_hoisted_3","for","type","$event","$data","currentPassword","required","_hoisted_4","newPassword","_hoisted_5","confirmPassword","disabled","loading","_hoisted_6","passwordMessage","key","_normalizeClass","passwordMessageClass"],"sources":["/Users/gentil/Desktop/Kozi-ai-agent/src/views/agent/ChangePassword.vue"],"sourcesContent":["<template>\n  <div\n    class=\"page-wrapper\"\n    id=\"main-wrapper\"\n    data-layout=\"vertical\"\n    data-navbarbg=\"skin6\"\n    data-sidebartype=\"full\"\n    data-sidebar-position=\"fixed\"\n    data-header-position=\"fixed\"\n  >\n    <!-- Sidebar Component -->\n    <IndexComponent />\n <div class=\"body-wrapper\" style=\"margin-top: -3rem;\">\n      <h2 style=\"margin-left:2rem;margin-right:2rem;\">Change Password</h2>\n      <form @submit.prevent=\"changePassword\" style=\"margin-left:2rem;margin-right:2rem;\">\n        <div class=\"form-group\">\n          <label for=\"current_password\" class=\"form-label\">Current password:</label>\n          <input\n            type=\"password\"\n            v-model=\"currentPassword\"\n            class=\"form-control\"\n            id=\"current_password\"\n            required\n          />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"new_password\" class=\"form-label\">New password:</label>\n          <input\n            type=\"password\"\n            v-model=\"newPassword\"\n            class=\"form-control\"\n            id=\"new_password\"\n            required\n          />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"confirm_password\" class=\"form-label\">Confirm New Password:</label>\n          <input\n            type=\"password\"\n            v-model=\"confirmPassword\"\n            class=\"form-control\"\n            id=\"confirm_password\"\n            required\n          />\n        </div>\n        <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"loading\">\n          {{ loading ? 'Changing...' : 'Change' }}\n        </button>\n        <br><br>\n        <p class=\"alert alert-danger\" v-if=\"passwordMessage\" :class=\"passwordMessageClass\" style=\"margin-left:5rem;\">\n        {{ passwordMessage }}\n      </p>\n      </form>\n\n      \n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport { globalVariable } from \"@/global\";\nimport IndexComponent from \"./IndexComponent.vue\";\n\nexport default {\n  name: \"MainWrapper\",\n  components: {\n    IndexComponent,\n  },\n  data() {\n    return {\n      userEmail: null,\n      users_id: null,\n      currentPassword: \"\",\n      newPassword: \"\",\n      confirmPassword: \"\",\n      passwordMessage: \"\",\n      passwordMessageClass: \"\",\n      feedback: \"\",\n      feedbackColor: \"green\",\n      loading: false,\n    };\n  },\n  computed: {\n    applyStatusClass() {\n      return this.feedbackColor === \"green\" ? \"alert-success\" : \"alert-danger\";\n    },\n  },\n  mounted() {\n    const token = localStorage.getItem(\"agentToken\");\n    if (token) {\n      try {\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        this.userEmail = payload.email;\n        this.getUserIdFromEmail();\n      } catch (e) {\n        console.error(\"Invalid JWT token:\", e);\n      }\n    }\n  },\n  methods: {\n    async getUserIdFromEmail() {\n      const token = localStorage.getItem(\"agentToken\");\n      if (!token || !this.userEmail) return;\n\n      try {\n        const res = await fetch(`${globalVariable}/get_user_id_by_email/${this.userEmail}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        const data = await res.json();\n        if (res.ok) {\n          this.users_id = data.users_id;\n        } else {\n          this.feedback = data.message || \"Unable to get user ID.\";\n          this.feedbackColor = \"red\";\n        }\n      } catch (err) {\n        console.error(\"Error getting users_id:\", err);\n        this.feedback = \"Failed to fetch user ID.\";\n        this.feedbackColor = \"red\";\n      }\n    },\n\n    async changePassword() {\n      if (this.newPassword !== this.confirmPassword) {\n        this.passwordMessage = \"New password and comfirm password doesn't match.\";\n        this.passwordMessageClass = \"text-danger\";\n        return;\n      }\n\n      this.loading = true;\n\n      try {\n        const token = localStorage.getItem(\"agentToken\");\n\n        const response = await axios.post(\n          `${globalVariable}/change-password`,\n          {\n            current_password: this.currentPassword,\n            new_password: this.newPassword,\n            confirm_password: this.confirmPassword,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${token}`,\n            },\n          }\n        );\n\n        if (response.data.success) {\n          this.passwordMessage = response.data.message;\n          this.passwordMessageClass = \"text-success\";\n          this.currentPassword = \"\";\n          this.newPassword = \"\";\n          this.confirmPassword = \"\";\n        } else {\n          this.passwordMessage = response.data.message;\n          this.passwordMessageClass = \"text-danger\";\n        }\n      } catch (error) {\n        console.error(\"Error:\", error);\n        this.passwordMessage =\n          error.response?.data?.message || \"An error occurred.\";\n        this.passwordMessageClass = \"text-danger\";\n      } finally {\n        this.loading = false;\n      }\n    },\n  },\n};\n</script>\n\n\n\n  \n  \n  \n  <style scoped>\n    .modal-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 1000;\n      }\n      \n      /* Modal content styling */\n      .modal-content {\n        background-color: white;\n        padding: 20px;\n        border-radius: 8px;\n        text-align: center;\n        width: 300px;\n      }\n    \n      .container-fluid {\n        max-width: 800px;\n        margin: auto;\n        padding: 20px;\n        background-color: #ffffff;\n        border-radius: 8px;\n        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);\n      }\n      \n      h5 {\n        color: #333;\n        margin-bottom: 20px;\n      }\n      \n      .form-control {\n        width: 100%;\n        padding: 15px;\n        height: 50px;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n        box-sizing: border-box;\n        transition: border-color 0.3s, box-shadow 0.3s;\n        font-size: 16px;\n      }\n      \n      .form-control:focus {\n        border-color: black;\n        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);\n        outline: none;\n      }\n      \n      .form-label {\n        font-weight: bold;\n        margin-bottom: 5px;\n        display: block;\n      }\n      \n      .btn-primary {\n        background-color:white;\n        color: black;\n        \n      }\n      \n      .btn-primary:hover {\n        background-color: #EA60A7;\n        color: white;\n        border: none;\n      }\n      \n      \n      .form-group {\n        margin-bottom: 15px;\n      }\n      \n      \n      </style>\n      "],"mappings":";;EAEIA,KAAK,EAAC,cAAc;EACpBC,EAAE,EAAC,cAAc;EACjB,aAAW,EAAC,UAAU;EACtB,eAAa,EAAC,OAAO;EACrB,kBAAgB,EAAC,MAAM;EACvB,uBAAqB,EAAC,OAAO;EAC7B,sBAAoB,EAAC;;;EAInBD,KAAK,EAAC,cAAc;EAACE,KAA0B,EAA1B;IAAA;EAAA;;;EAGdF,KAAK,EAAC;AAAY;;EAUlBA,KAAK,EAAC;AAAY;;EAUlBA,KAAK,EAAC;AAAY;mBAnC/B;;;uBACEG,mBAAA,CAuDM,OAvDNC,UAuDM,GA9CJC,mBAAA,uBAA0B,EAC1BC,YAAA,CAAkBC,yBAAA,GACrBC,mBAAA,CA2CS,OA3CTC,UA2CS,G,0BA1CJD,mBAAA,CAAoE;IAAhEN,KAA2C,EAA3C;MAAA;MAAA;IAAA;EAA2C,GAAC,iBAAe,sBAC/DM,mBAAA,CAsCO;IAtCAE,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAdnBC,cAAA,KAAAC,IAAA,KAc6BC,QAAA,CAAAC,cAAA,IAAAD,QAAA,CAAAC,cAAA,IAAAF,IAAA,CAAc;IAAEX,KAA2C,EAA3C;MAAA;MAAA;IAAA;MACrCM,mBAAA,CASM,OATNQ,UASM,G,0BARJR,mBAAA,CAA0E;IAAnES,GAAG,EAAC,kBAAkB;IAACjB,KAAK,EAAC;KAAa,mBAAiB,sB,gBAClEQ,mBAAA,CAME;IALAU,IAAI,EAAC,UAAU;IAlB3B,uBAAAP,MAAA,QAAAA,MAAA,MAAAQ,MAAA,IAmBqBC,KAAA,CAAAC,eAAe,GAAAF,MAAA;IACxBnB,KAAK,EAAC,cAAc;IACpBC,EAAE,EAAC,kBAAkB;IACrBqB,QAAQ,EAAR;iDAHSF,KAAA,CAAAC,eAAe,E,KAM5Bb,mBAAA,CASM,OATNe,UASM,G,0BARJf,mBAAA,CAAkE;IAA3DS,GAAG,EAAC,cAAc;IAACjB,KAAK,EAAC;KAAa,eAAa,sB,gBAC1DQ,mBAAA,CAME;IALAU,IAAI,EAAC,UAAU;IA5B3B,uBAAAP,MAAA,QAAAA,MAAA,MAAAQ,MAAA,IA6BqBC,KAAA,CAAAI,WAAW,GAAAL,MAAA;IACpBnB,KAAK,EAAC,cAAc;IACpBC,EAAE,EAAC,cAAc;IACjBqB,QAAQ,EAAR;iDAHSF,KAAA,CAAAI,WAAW,E,KAMxBhB,mBAAA,CASM,OATNiB,UASM,G,0BARJjB,mBAAA,CAA8E;IAAvES,GAAG,EAAC,kBAAkB;IAACjB,KAAK,EAAC;KAAa,uBAAqB,sB,gBACtEQ,mBAAA,CAME;IALAU,IAAI,EAAC,UAAU;IAtC3B,uBAAAP,MAAA,QAAAA,MAAA,MAAAQ,MAAA,IAuCqBC,KAAA,CAAAM,eAAe,GAAAP,MAAA;IACxBnB,KAAK,EAAC,cAAc;IACpBC,EAAE,EAAC,kBAAkB;IACrBqB,QAAQ,EAAR;iDAHSF,KAAA,CAAAM,eAAe,E,KAM5BlB,mBAAA,CAES;IAFDU,IAAI,EAAC,QAAQ;IAAClB,KAAK,EAAC,iBAAiB;IAAE2B,QAAQ,EAAEP,KAAA,CAAAQ;sBACpDR,KAAA,CAAAQ,OAAO,mDA9CpBC,UAAA,G,0BAgDQrB,mBAAA,CAAI,sC,0BAAAA,mBAAA,CAAI,sCAC4BY,KAAA,CAAAU,eAAe,I,cAAnD3B,mBAAA,CAEE;IAnDV4B,GAAA;IAiDW/B,KAAK,EAjDhBgC,eAAA,EAiDiB,oBAAoB,EAAgCZ,KAAA,CAAAa,oBAAoB;IAAE/B,KAAyB,EAAzB;MAAA;IAAA;sBAChFkB,KAAA,CAAAU,eAAe,2BAlD1BzB,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}